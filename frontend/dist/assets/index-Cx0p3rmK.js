import{r as m,j as e,b as ae,d as U,e as G,T as oe,B as ce,L as le,S as de,M as he,f as j,h as me,Z as xe,C as ue,i as pe,k as fe,R as ve}from"./vendor-react-DaXMc0bt.js";import{S as ge,O as ye,W as be,C as w,B as je,F as S,a as ke,A as we,V as Q,P as Se}from"./vendor-three-CRv_4cem.js";import{R as N,L as F,C as z,X as R,Y as M,T as A,a as I,b as Ne,B as Ae,c as _e,P as Ce,d as ze,e as Re}from"./vendor-charts-B8mNDg7w.js";import"./vendor-C1sGr1PS.js";import"./vendor-lodash-D7-b6lnI.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))h(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&h(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function h(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function $(){const[o,t]=m.useState({x:0,y:0}),[n,h]=m.useState({x:0,y:0}),s=m.useRef({x:0,y:0});return m.useRef(.95),m.useEffect(()=>{const r=c=>{const l={x:c.clientX,y:c.clientY},i={x:(l.x-s.current.x)*.1,y:(l.y-s.current.y)*.1};t(l),h(i),s.current=l};return window.addEventListener("mousemove",r),()=>window.removeEventListener("mousemove",r)},[]),{cursorPos:o,mouseVelocity:n,getInfluence:(r,c=300,l=1)=>{if(!r)return{x:0,y:0,distance:1/0};const i={x:r.left+r.width/2,y:r.top+r.height/2},d=Math.hypot(o.x-i.x,o.y-i.y);if(d>c)return{x:0,y:0,distance:d};const x=Math.max(0,1-d/c),u=(i.x-o.x)/d,f=(i.y-o.y)/d;return{x:u*x*l,y:f*x*l,distance:d,influence:x}}}}function Me(){const o=()=>{const s=localStorage.getItem("theme");return s?s==="dark":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches},[t,n]=m.useState(o);return m.useEffect(()=>{t?(document.documentElement.classList.add("dark-mode"),document.documentElement.classList.remove("light-mode")):(document.documentElement.classList.add("light-mode"),document.documentElement.classList.remove("dark-mode")),localStorage.setItem("theme",t?"dark":"light")},[t]),m.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),a=r=>{localStorage.getItem("theme")||n(r.matches)};return s.addEventListener("change",a),()=>s.removeEventListener("change",a)},[]),{isDark:t,toggle:()=>n(s=>!s)}}function Ie({activeSection:o,setActiveSection:t}){const{getInfluence:n}=$(),{isDark:h,toggle:s}=Me(),a=m.useRef([]),r=[{id:"dashboard",label:"Dashboard",icon:U},{id:"live-traffic",label:"Live Traffic",icon:U},{id:"detected-attacks",label:"Attacks",icon:G},{id:"risk-analysis",label:"Risk Analysis",icon:oe},{id:"attack-analytics",label:"Analytics",icon:ce},{id:"blocked-ips",label:"Blocked IPs",icon:le}];return m.useEffect(()=>{let c=null;const l=()=>{a.current.forEach(i=>{if(!i)return;const d=i.getBoundingClientRect(),x=n(d,150,2);i.style.transform=`translate(${x.x}px, ${x.y}px)`}),c=requestAnimationFrame(l)};return c=requestAnimationFrame(l),()=>cancelAnimationFrame(c)},[n]),e.jsx("nav",{className:"navbar",children:e.jsxs("div",{className:"navbar-container",children:[e.jsxs("div",{className:"navbar-brand",children:[e.jsx(ae,{size:28,className:"navbar-icon"}),e.jsx("span",{className:"navbar-title",children:"Network Attack"})]}),e.jsx("div",{className:"navbar-menu",children:r.map((c,l)=>{const i=c.icon,d=o===c.id;return e.jsxs("button",{onClick:()=>t(c.id),ref:x=>{a.current[l]=x},className:`nav-button ${d?"active":""}`,style:{transition:"all 0.15s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform",background:"none",border:"none",cursor:"pointer"},children:[e.jsx(i,{size:18,className:"nav-icon"}),e.jsx("span",{className:"nav-label",children:c.label})]},c.id)})}),e.jsxs("div",{className:"navbar-status",children:[e.jsx("span",{className:"status-indicator"}),"Active"]}),e.jsx("button",{className:"navbar-theme-toggle",onClick:s,"aria-label":"Toggle dark mode",title:h?"Switch to light mode":"Switch to dark mode",children:h?e.jsx(de,{size:18}):e.jsx(he,{size:18})})]})})}const Pe=()=>{const o=m.useRef(null),t=m.useRef(null),n=m.useRef(null),h=m.useRef(null),s=m.useRef([]),a=m.useRef({x:0,y:0,targetX:0,targetY:0}),r=m.useRef(0),c=m.useRef(null);return m.useEffect(()=>{if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window)return;const i=o.current,d=window.innerWidth,x=window.innerHeight,u=new ge;t.current=u;const f=new ye(d/-2,d/2,x/2,x/-2,1,1e3);f.position.z=500,h.current=f;const v=new be({alpha:!0,antialias:!0,powerPreference:"high-performance"});v.setSize(d,x),v.setPixelRatio(Math.min(window.devicePixelRatio,2)),i.appendChild(v.domElement),n.current=v;const Z=`
      uniform float time;
      uniform vec2 mouse;
      uniform float clusterPhase;
      uniform vec2 clusterCenter;
      uniform float rotationSpeed;
      
      attribute vec3 offset;
      attribute float angle;
      attribute float speed;
      attribute vec3 color;
      attribute float size;
      
      varying vec3 vColor;
      varying float vAlpha;
      
      void main() {
        vColor = color;
        
        // Calculate rotation influence based on mouse
        vec2 mouseInfluence = mouse * 0.3;
        float rotationAngle = time * rotationSpeed + clusterPhase + 
                              length(mouseInfluence) * 0.5;
        
        // Rotate particle position
        float cos_r = cos(rotationAngle + angle);
        float sin_r = sin(rotationAngle + angle);
        
        vec3 rotated = vec3(
          offset.x * cos_r - offset.y * sin_r,
          offset.x * sin_r + offset.y * cos_r,
          offset.z
        );
        
        // Add wave motion
        float wave = sin(time * speed + angle * 2.0) * 15.0;
        rotated.x += wave;
        rotated.y += cos(time * speed + angle) * 15.0;
        
        // Mouse interaction - pull particles slightly toward mouse
        vec2 toMouse = mouseInfluence * 50.0;
        rotated.xy += toMouse * (1.0 - length(offset.xy) / 300.0) * 0.3;
        
        // Apply cluster center
        vec3 finalPosition = rotated + vec3(clusterCenter, 0.0);
        
        vec4 mvPosition = modelViewMatrix * vec4(finalPosition, 1.0);
        gl_Position = projectionMatrix * mvPosition;
        
        // Size and alpha based on depth and distance
        float distanceFromCenter = length(offset.xy) / 300.0;
        gl_PointSize = size * (1.0 - distanceFromCenter * 0.3) * (300.0 / -mvPosition.z);
        
        vAlpha = 0.6 + sin(time * speed * 2.0) * 0.3;
        vAlpha *= (1.0 - distanceFromCenter * 0.5);
      }
    `,J=`
      varying vec3 vColor;
      varying float vAlpha;
      
      void main() {
        // Create dash/line shape
        vec2 center = gl_PointCoord - vec2(0.5);
        float dist = length(center);
        
        // Elongated dash shape
        float dashShape = 1.0 - smoothstep(0.0, 0.5, abs(center.x) * 2.0);
        dashShape *= 1.0 - smoothstep(0.0, 0.3, abs(center.y) * 4.0);
        
        float alpha = dashShape * vAlpha;
        
        if (alpha < 0.01) discard;
        
        gl_FragColor = vec4(vColor, alpha);
      }
    `,O=[new w(4886754),new w(8087790),new w(5294200),new w(16032864),new w(16739229),new w(52945)],D=6,ee=300;for(let p=0;p<D;p++){const g=new je,b=[],_=[],P=[],C=[],E=[],L=[];for(let Y=0;Y<ee;Y++){b.push(0,0,0);const V=Math.pow(Math.random(),.7)*280+20,W=Math.random()*Math.PI*2;_.push(Math.cos(W)*V,Math.sin(W)*V,(Math.random()-.5)*50),P.push(W),C.push(.5+Math.random()*1);const T=O[Math.floor(Math.random()*O.length)];E.push(T.r,T.g,T.b),L.push(3+Math.random()*4)}g.setAttribute("position",new S(b,3)),g.setAttribute("offset",new S(_,3)),g.setAttribute("angle",new S(P,1)),g.setAttribute("speed",new S(C,1)),g.setAttribute("color",new S(E,3)),g.setAttribute("size",new S(L,1));const k=3,B=2,te=p%k,se=Math.floor(p/k),re=(te-(k-1)/2)*(d/(k+.5)),ie=(se-(B-1)/2)*(x/(B+.5)),ne=new ke({uniforms:{time:{value:0},mouse:{value:new Q(0,0)},clusterPhase:{value:p/D*Math.PI*2},clusterCenter:{value:new Q(re,ie)},rotationSpeed:{value:.1+Math.random()*.1}},vertexShader:Z,fragmentShader:J,transparent:!0,depthTest:!1,depthWrite:!1,blending:we}),K=new Se(g,ne);u.add(K),s.current.push(K)}const H=p=>{a.current.targetX=p.clientX/d*2-1,a.current.targetY=-(p.clientY/x)*2+1};window.addEventListener("mousemove",H);const X=()=>{c.current=requestAnimationFrame(X),r.current+=.01,a.current.x+=(a.current.targetX-a.current.x)*.05,a.current.y+=(a.current.targetY-a.current.y)*.05,s.current.forEach(p=>{p.material.uniforms.time.value=r.current,p.material.uniforms.mouse.value.set(a.current.x,a.current.y)}),v.render(u,f)};X();const q=()=>{const p=window.innerWidth,g=window.innerHeight;f.left=p/-2,f.right=p/2,f.top=g/2,f.bottom=g/-2,f.updateProjectionMatrix(),v.setSize(p,g);const b=3,_=2;s.current.forEach((P,C)=>{const E=C%b,L=Math.floor(C/b),k=(E-(b-1)/2)*(p/(b+.5)),B=(L-(_-1)/2)*(g/(_+.5));P.material.uniforms.clusterCenter.value.set(k,B)})};return window.addEventListener("resize",q),()=>{window.removeEventListener("mousemove",H),window.removeEventListener("resize",q),c.current&&cancelAnimationFrame(c.current),s.current.forEach(p=>{p.geometry.dispose(),p.material.dispose(),u.remove(p)}),v.dispose(),i.removeChild(v.domElement)}},[]),e.jsx("div",{ref:o,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:0,pointerEvents:"none",background:"transparent"}})};function y(o,t=5e3){const[n,h]=m.useState(null),[s,a]=m.useState(!0),[r,c]=m.useState(null),l=async()=>{try{c(null);const i=await fetch(o);if(!i.ok)throw new Error(`API Error: ${i.status}`);const d=await i.json();h(d),a(!1)}catch(i){c(i.message),a(!1)}};return m.useEffect(()=>{l();const i=setInterval(l,t);return()=>clearInterval(i)},[o,t]),{data:n,loading:s,error:r,refetch:l}}function Ee(){const{data:o,error:t}=y("http://127.0.0.1:8000/api/health"),{data:n,error:h}=y("http://127.0.0.1:8000/api/metrics"),{data:s,error:a}=y("http://127.0.0.1:8000/api/analytics/timeline"),{getInfluence:r}=$(),c=m.useRef([]),l=t||h||a,i=(s==null?void 0:s.timeline)||[];return m.useEffect(()=>{let d=null;const x=()=>{c.current.forEach(u=>{if(!u)return;const f=u.getBoundingClientRect(),v=r(f,200,8);u.style.transform=`translate(${v.x}px, ${v.y}px)`}),d=requestAnimationFrame(x)};return d=requestAnimationFrame(x),()=>cancelAnimationFrame(d)},[r]),e.jsxs("div",{children:[l&&e.jsxs("div",{className:"demo-banner",children:[e.jsx(j,{size:16}),"Backend offline - Check your API connection"]}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{ref:d=>c.current[0]=d,className:"metric-card health",style:{transition:"transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:[e.jsx("div",{className:"metric-label",children:"System Health"}),e.jsx("div",{className:"metric-value",children:(o==null?void 0:o.status)==="healthy"?"Healthy":(o==null?void 0:o.status)||"Unknown"}),e.jsx(me,{size:40,className:"metric-icon"}),e.jsx("div",{className:"metric-subtext",children:o!=null&&o.last_checked?`Updated: ${new Date(o.last_checked).toLocaleTimeString()}`:"Loading..."})]}),e.jsxs("div",{ref:d=>c.current[1]=d,className:"metric-card detections",style:{transition:"transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:[e.jsx("div",{className:"metric-label",children:"Total Detections"}),e.jsx("div",{className:"metric-value",children:(n==null?void 0:n.total_detections)||"0"}),e.jsx(G,{size:40,className:"metric-icon"}),e.jsx("div",{className:"metric-subtext",children:"All time"})]}),e.jsxs("div",{ref:d=>c.current[2]=d,className:"metric-card risky",style:{transition:"transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:[e.jsx("div",{className:"metric-label",children:"Active Risky IPs"}),e.jsx("div",{className:"metric-value",children:(n==null?void 0:n.active_risky_ips)||"0"}),e.jsx(j,{size:40,className:"metric-icon"}),e.jsx("div",{className:"metric-subtext",children:"Currently monitored"})]}),e.jsxs("div",{ref:d=>c.current[3]=d,className:"metric-card confidence",style:{transition:"transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:[e.jsx("div",{className:"metric-label",children:"Avg Confidence"}),e.jsx("div",{className:"metric-value",children:n!=null&&n.average_confidence?`${n.average_confidence.toFixed(1)}%`:"N/A"}),e.jsx(xe,{size:40,className:"metric-icon"}),e.jsx("div",{className:"metric-subtext",children:n!=null&&n.last_detection?`Last: ${new Date(n.last_detection).toLocaleTimeString()}`:"No detections"})]})]}),i.length>0&&e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{className:"chart-title",children:"Traffic Timeline"}),e.jsx(N,{width:"100%",height:300,children:e.jsxs(F,{data:i,children:[e.jsx(z,{strokeDasharray:"3 3",stroke:"var(--border-light)"}),e.jsx(R,{dataKey:"timestamp",stroke:"var(--text-tertiary)"}),e.jsx(M,{stroke:"var(--text-tertiary)"}),e.jsx(A,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-medium)",borderRadius:"8px"},labelStyle:{color:"var(--text-primary)"}}),e.jsx(I,{type:"monotone",dataKey:"packet_count",stroke:"#4285f4",dot:!1,strokeWidth:2})]})})]})]})}function Le(){const[o,t]=m.useState("1h"),{data:n,error:h}=y("http://127.0.0.1:8000/api/analytics/timeline?window="+o),s=(n==null?void 0:n.timeline)||[];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"32px",fontWeight:500,color:"var(--text-primary)",marginBottom:"8px"},children:"Live Traffic Monitor"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"Real-time network activity visualization"})]}),e.jsxs("div",{className:"time-range-buttons",children:[e.jsx("button",{className:`time-btn ${o==="5m"?"active":""}`,onClick:()=>t("5m"),children:"5 Minutes"}),e.jsx("button",{className:`time-btn ${o==="1h"?"active":""}`,onClick:()=>t("1h"),children:"1 Hour"}),e.jsx("button",{className:`time-btn ${o==="24h"?"active":""}`,onClick:()=>t("24h"),children:"24 Hours"})]})]}),h&&e.jsxs("div",{className:"demo-banner",children:[e.jsx(j,{size:16}),"Backend offline - Check your API connection"]}),s.length>0&&e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{className:"chart-title",children:"Traffic Over Time"}),e.jsx(N,{width:"100%",height:350,children:e.jsxs(F,{data:s,children:[e.jsx(z,{strokeDasharray:"3 3",stroke:"var(--border-light)"}),e.jsx(R,{dataKey:"timestamp",stroke:"var(--text-tertiary)"}),e.jsx(M,{stroke:"var(--text-tertiary)"}),e.jsx(A,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-medium)",borderRadius:"8px"},labelStyle:{color:"var(--text-primary)"}}),e.jsx(Ne,{}),e.jsx(I,{type:"monotone",dataKey:"packet_count",stroke:"#4285f4",dot:!1,strokeWidth:2,name:"Packets"}),e.jsx(I,{type:"monotone",dataKey:"event_count",stroke:"#ea4335",dot:!1,strokeWidth:2,name:"Events"})]})})]})]})}function Be(){const{data:o,error:t}=y("http://127.0.0.1:8000/api/detections"),n=(o==null?void 0:o.detections)||[],h=r=>r<30?"risk-low":r<70?"risk-medium":"risk-high",s=r=>r==="logged"?"badge-logged":r==="quarantined"?"badge-quarantined":"badge-blocked",a=r=>e.jsxs("div",{className:"risk-bar",children:[e.jsxs("span",{style:{minWidth:"30px"},children:[r.toFixed(1),"%"]}),e.jsx("div",{className:"risk-bar-container",children:e.jsx("div",{className:"risk-bar-fill",style:{width:`${Math.min(r,100)}%`,background:r>70?"#34a853":r>40?"#fbbc04":"#ea4335"}})})]});return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h2",{style:{fontSize:"32px",fontWeight:500,color:"var(--text-primary)",marginBottom:"8px"},children:"Detected Attacks"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"Real-time attack detection log"})]}),t&&e.jsxs("div",{className:"demo-banner",children:[e.jsx(j,{size:16}),"Backend offline - Check your API connection"]}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{className:"chart-title",children:"Detection Log"}),e.jsxs("div",{style:{fontSize:"12px",color:"#ea4335",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{width:"8px",height:"8px",background:"#ea4335",borderRadius:"50%"}}),"Auto-refresh every 5s"]})]}),n.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Timestamp"}),e.jsx("th",{children:"Source IP"}),e.jsx("th",{children:"Attack Type"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Risk Score"}),e.jsx("th",{children:"Confidence"})]})}),e.jsx("tbody",{children:n.map((r,c)=>e.jsxs("tr",{style:{background:r.risk_score>70?"rgba(234, 67, 53, 0.05)":"transparent"},children:[e.jsx("td",{children:new Date(r.timestamp).toLocaleString()}),e.jsx("td",{style:{color:"var(--accent-blue)",fontFamily:"monospace",fontSize:"13px"},children:r.source_ip}),e.jsx("td",{children:r.attack_type}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s(r.action)}`,children:r.action})}),e.jsx("td",{children:e.jsxs("div",{className:"risk-bar",children:[e.jsx("span",{style:{minWidth:"30px"},children:r.risk_score.toFixed(1)}),e.jsx("div",{className:"risk-bar-container",children:e.jsx("div",{className:`risk-bar-fill ${h(r.risk_score)}`,style:{width:`${Math.min(r.risk_score,100)}%`}})})]})}),e.jsx("td",{children:a(r.confidence)})]},c))})]}):e.jsx("p",{style:{padding:"20px",textAlign:"center",color:"var(--text-secondary)"},children:t?"Unable to load detections":"No attacks detected"})]})]})}function Fe(){const[o,t]=m.useState(null),[n,h]=m.useState("1h"),{data:s,error:a}=y(`http://127.0.0.1:8000/api/analytics/risk?window=${n}`),r=(s==null?void 0:s.risks)||[],c=i=>i<30?{text:"Low",color:"#34a853"}:i<70?{text:"Medium",color:"#fbbc04"}:{text:"High",color:"#ea4335"},l=i=>e.jsxs("div",{className:"risk-bar",children:[e.jsxs("span",{style:{minWidth:"30px"},children:[i.toFixed(1),"%"]}),e.jsx("div",{className:"risk-bar-container",children:e.jsx("div",{className:"risk-bar-fill",style:{width:`${Math.min(i,100)}%`,background:i>70?"#34a853":i>40?"#fbbc04":"#ea4335"}})})]});return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h2",{style:{fontSize:"32px",fontWeight:500,color:"var(--text-primary)",marginBottom:"8px"},children:"Risk Analysis"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"Intelligence-driven per-IP risk assessment"})]}),a&&e.jsxs("div",{className:"demo-banner",children:[e.jsx(j,{size:16}),"Backend offline - Check your API connection"]}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"Risk Scores by IP"}),e.jsx("p",{style:{fontSize:"12px",color:"var(--text-secondary)",marginTop:"4px"},children:"Click row to expand details"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx("button",{onClick:()=>h("1h"),style:{padding:"6px 12px",background:n==="1h"?"#1f71e5":"transparent",color:n==="1h"?"white":"#5f6368",border:"1px solid #dadce0",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"1h"}),e.jsx("button",{onClick:()=>h("24h"),style:{padding:"6px 12px",background:n==="24h"?"#1f71e5":"transparent",color:n==="24h"?"white":"#5f6368",border:"1px solid #dadce0",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"24h"})]})]}),r.length>0?e.jsx("div",{className:"expandable-table",children:r.map((i,d)=>{var x;return e.jsxs("div",{className:"expandable-row-wrapper",children:[e.jsx("div",{className:"expandable-row",onClick:()=>t(o===d?null:d),style:{background:i.risk_score>70?"rgba(234, 67, 53, 0.05)":"transparent",cursor:"pointer"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:"16px",padding:"12px 16px"},children:[e.jsx(ue,{size:18,style:{transform:o===d?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s",color:"var(--text-secondary)",flexShrink:0}}),e.jsx("div",{style:{minWidth:"120px"},children:e.jsx("div",{style:{fontFamily:"monospace",fontSize:"13px",color:"var(--accent-blue)"},children:i.ip_address})}),e.jsx("div",{style:{minWidth:"100px"},children:e.jsxs("div",{className:"risk-bar",children:[e.jsx("span",{style:{minWidth:"30px"},children:i.risk_score.toFixed(1)}),e.jsx("div",{className:"risk-bar-container",children:e.jsx("div",{className:"risk-bar-fill",style:{width:`${Math.min(i.risk_score,100)}%`,background:i.risk_score>70?"#ea4335":i.risk_score>40?"#fbbc04":"#34a853"}})})]})}),e.jsx("div",{style:{minWidth:"80px"},children:e.jsx("span",{style:{background:c(i.risk_score).color+"20",color:c(i.risk_score).color,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},children:c(i.risk_score).text})}),e.jsx("div",{style:{minWidth:"150px"},children:l(i.confidence)}),e.jsxs("div",{style:{minWidth:"50px",textAlign:"right",color:"var(--text-secondary)"},children:[i.attack_count," attacks"]})]})}),o===d&&e.jsx("div",{className:"expanded-details",children:e.jsxs("div",{style:{padding:"16px",borderLeft:"3px solid #1f71e5",background:"var(--bg-card)"},children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{fontSize:"13px",fontWeight:600,color:"var(--text-primary)",marginBottom:"8px"},children:"Confidence Explanation"}),e.jsx("p",{style:{fontSize:"12px",color:"var(--text-secondary)",lineHeight:"1.6"},children:i.confidence_explanation||"No explanation available"})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{fontSize:"13px",fontWeight:600,color:"var(--text-primary)",marginBottom:"8px"},children:"Attack Types"}),e.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:((x=i.attack_labels)==null?void 0:x.map((u,f)=>e.jsx("span",{style:{background:"var(--accent-blue-light)",color:"var(--accent-blue)",padding:"4px 8px",borderRadius:"3px",fontSize:"11px"},children:u},f)))||e.jsx("span",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:"No attack labels"})})]}),i.timeline&&i.timeline.length>0&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{fontSize:"13px",fontWeight:600,color:"var(--text-primary)",marginBottom:"8px"},children:"Activity Timeline"}),e.jsx("div",{style:{height:"150px",width:"100%"},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(F,{data:i.timeline,children:[e.jsx(z,{strokeDasharray:"3 3",stroke:"var(--border-light)"}),e.jsx(R,{dataKey:"time",tick:{fontSize:11,fill:"var(--text-secondary)"}}),e.jsx(M,{tick:{fontSize:11,fill:"var(--text-secondary)"}}),e.jsx(A,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-medium)",borderRadius:"4px"},labelStyle:{color:"var(--text-primary)"}}),e.jsx(I,{type:"monotone",dataKey:"risk_score",stroke:"#1f71e5",strokeWidth:2,dot:{r:3}})]})})})]})]})})]},d)})}):e.jsx("p",{style:{padding:"20px",textAlign:"center",color:"var(--text-secondary)"},children:a?"Unable to load risk data":"No risk data available"})]})]})}function We(){const{data:o,error:t}=y("http://127.0.0.1:8000/api/analytics/attack_trends"),{data:n,error:h}=y("http://127.0.0.1:8000/api/analytics/top_attackers"),{data:s,error:a}=y("http://127.0.0.1:8000/api/analytics/timeline"),r=(o==null?void 0:o.attack_trends)||[],c=(s==null?void 0:s.timeline)||[],l=(n==null?void 0:n.severity_distribution)||[],i=["#ea4335","#fbbc04","#34a853"],d=t||h||a;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h2",{style:{fontSize:"32px",fontWeight:500,color:"var(--text-primary)",marginBottom:"8px"},children:"Attack Analytics"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"Trends and insights from attack data"})]}),d&&e.jsxs("div",{className:"demo-banner",children:[e.jsx(j,{size:16}),"Backend offline - Check your API connection"]}),r.length>0&&e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{className:"chart-title",children:"Attack Type Distribution"}),e.jsx(N,{width:"100%",height:300,children:e.jsxs(Ae,{data:r,children:[e.jsx(z,{strokeDasharray:"3 3",stroke:"var(--border-light)"}),e.jsx(R,{dataKey:"name",stroke:"var(--text-tertiary)"}),e.jsx(M,{stroke:"var(--text-tertiary)"}),e.jsx(A,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-medium)",borderRadius:"8px"},labelStyle:{color:"var(--text-primary)"}}),e.jsx(_e,{dataKey:"value",fill:"#fbbc04"})]})})]}),e.jsxs("div",{className:"grid-2",children:[c.length>0&&e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{className:"chart-title",children:"Attacks Over Time"}),e.jsx(N,{width:"100%",height:250,children:e.jsxs(F,{data:c,children:[e.jsx(z,{strokeDasharray:"3 3",stroke:"var(--border-light)"}),e.jsx(R,{dataKey:"time",stroke:"var(--text-tertiary)"}),e.jsx(M,{stroke:"var(--text-tertiary)"}),e.jsx(A,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-medium)",borderRadius:"8px"},labelStyle:{color:"var(--text-primary)"}}),e.jsx(I,{type:"monotone",dataKey:"count",stroke:"#ea4335",dot:!1,strokeWidth:2})]})})]}),l.length>0&&e.jsxs("div",{className:"chart-container",children:[e.jsx("h3",{className:"chart-title",children:"Severity Distribution"}),e.jsx(N,{width:"100%",height:250,children:e.jsxs(Ce,{children:[e.jsx(ze,{data:l,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:l.map((x,u)=>e.jsx(Re,{fill:i[u%i.length]},`cell-${u}`))}),e.jsx(A,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-medium)",borderRadius:"8px"},labelStyle:{color:"var(--text-primary)"}})]})}),e.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"20px",marginTop:"16px",fontSize:"14px"},children:l.map((x,u)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{width:"12px",height:"12px",background:i[u%i.length],borderRadius:"2px"}}),e.jsxs("span",{children:[x.name," ",(x.value/l.reduce((f,v)=>f+v.value,0)*100).toFixed(0),"%"]})]},u))})]})]})]})}function Te(){const{data:o,error:t,refetch:n}=y("http://127.0.0.1:8000/api/blocked_ips"),h=(o==null?void 0:o.blocked_ips)||[],s=(o==null?void 0:o.stats)||{},a=r=>r<30?"risk-low":r<70?"risk-medium":"risk-high";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"32px",fontWeight:500,color:"var(--text-primary)",marginBottom:"8px"},children:"Blocked IPs"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"Automated defense actions log"})]}),e.jsxs("button",{onClick:n,className:"header-action",style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",background:"#1f71e5",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:[e.jsx(pe,{size:16}),"Refresh"]})]}),t&&e.jsxs("div",{className:"demo-banner",children:[e.jsx(j,{size:16}),"Backend offline - Check your API connection"]}),e.jsxs("div",{className:"grid-3",children:[e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-label",style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{color:"#ea4335",fontSize:"16px"},children:"ðŸš«"}),"Total Blocked"]}),e.jsx("div",{className:"metric-value",children:s.total_blocked||0})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Avg Risk Score"}),e.jsx("div",{className:"metric-value",children:(s.avg_risk_score||0).toFixed(1)})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-label",children:"Last Blocked"}),e.jsx("div",{className:"metric-value",style:{fontSize:"14px"},children:s.last_blocked_at?new Date(s.last_blocked_at).toLocaleString():"N/A"})]})]}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{className:"chart-title",children:"Blocked IP Log"}),e.jsxs("div",{style:{fontSize:"12px",color:"#ea4335",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{width:"8px",height:"8px",background:"#ea4335",borderRadius:"50%"}}),"Auto-refresh every 5s"]})]}),h.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"30px"}}),e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"Blocked At"}),e.jsx("th",{children:"Reason / Attack Type"}),e.jsx("th",{children:"Risk Score at Block"})]})}),e.jsx("tbody",{children:h.map((r,c)=>e.jsxs("tr",{style:{background:r.risk_score>70?"rgba(234, 67, 53, 0.05)":"transparent"},children:[e.jsx("td",{style:{cursor:"pointer",color:"#ea4335"},children:"ðŸš«"}),e.jsx("td",{style:{fontFamily:"monospace",fontSize:"13px",color:"var(--accent-blue)"},children:r.ip_address}),e.jsx("td",{children:new Date(r.blocked_at).toLocaleString()}),e.jsx("td",{style:{color:"var(--accent-red)"},children:r.reason}),e.jsx("td",{children:e.jsxs("div",{className:"risk-bar",children:[e.jsx("span",{style:{minWidth:"40px"},children:r.risk_score.toFixed(1)}),e.jsx("div",{className:"risk-bar-container",children:e.jsx("div",{className:`risk-bar-fill ${a(r.risk_score)}`,style:{width:`${Math.min(r.risk_score,100)}%`}})})]})})]},c))})]}):e.jsx("p",{style:{padding:"20px",textAlign:"center",color:"var(--text-secondary)"},children:t?"Unable to load blocked IPs":"No blocked IPs"})]})]})}function $e({activeSection:o,setActiveSection:t}){const{getInfluence:n}=$(),h=m.useRef({});m.useEffect(()=>{let a=null;return a=requestAnimationFrame(()=>{const c=h.current[o];if(!c)return;const l=c.getBoundingClientRect(),i=n(l,200,2);c.style.transform=`translate(${i.x}px, ${i.y}px)`}),()=>cancelAnimationFrame(a)},[o,n]);const s={dashboard:{component:Ee,label:"Dashboard"},"live-traffic":{component:Le,label:"Live Traffic"},"detected-attacks":{component:Be,label:"Detected Attacks"},"risk-analysis":{component:Fe,label:"Risk Analysis"},"attack-analytics":{component:We,label:"Attack Analytics"},"blocked-ips":{component:Te,label:"Blocked IPs"}};return e.jsx("div",{className:"unified-dashboard",children:Object.entries(s).map(([a,{component:r}])=>{const c=o===a;return e.jsx("section",{ref:l=>{h.current[a]=l},className:`dashboard-section ${c?"active":"inactive"}`,style:{opacity:c?1:0,pointerEvents:c?"auto":"none",transition:"opacity 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:c?"translateX(0) scale(1)":"translateX(40px) scale(0.95)",willChange:"opacity, transform"},children:e.jsx(r,{})},a)})})}class Oe{constructor(t={}){this.config={particleCount:t.particleCount||140,zIndex:t.zIndex!==void 0?t.zIndex:-1,cursorInfluenceRadius:t.cursorInfluenceRadius||220,attractionStrength:t.attractionStrength||8e-4,orbitalStrength:t.orbitalStrength||35e-5,damping:t.damping||.94,cohesionRadius:t.cohesionRadius||180,cohesionStrength:t.cohesionStrength||15e-5,driftSpeed:t.driftSpeed||.3,colors:t.colors||[{r:100,g:220,b:255},{r:180,g:120,b:255},{r:255,g:100,b:200}],particleSize:t.particleSize||2.5,glowStrength:t.glowStrength||12,opacity:t.opacity||.7,autoScaleParticles:t.autoScaleParticles!==!1},this.canvas=null,this.ctx=null,this.particles=[],this.cursor={x:window.innerWidth/2,y:window.innerHeight/2},this.isActive=!0,this.animationFrameId=null,this._init()}_init(){this._createCanvas(),this._createParticles(),this._setupEventListeners(),this._startAnimation()}_createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.id="cursor-energy-field",Object.assign(this.canvas.style,{position:"fixed",top:"0",left:"0",width:"100vw",height:"100vh",pointerEvents:"none",zIndex:this.config.zIndex.toString(),opacity:"1"}),this.ctx=this.canvas.getContext("2d",{alpha:!0}),this._resize(),document.body.appendChild(this.canvas)}_createParticles(){this.particles=[];const t=30,n=Math.ceil(window.innerWidth/t),h=Math.ceil(window.innerHeight/t);for(let s=0;s<h;s++)for(let a=0;a<n;a++){const r=Math.random()>.5?"1":"0",c=document.documentElement.classList.contains("light-mode"),l=document.documentElement.classList.contains("dark-mode");let i;c?i=!1:l?i=!0:i=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;const d={x:a*t+t/2,y:s*t+t/2,originX:a*t+t/2,originY:s*t+t/2,vx:0,vy:0,mass:1,digit:r,color:r==="1"?i?{r:255,g:40,b:80}:{r:255,g:50,b:50}:i?{r:40,g:200,b:255}:{r:50,g:150,b:255},opacity:0,targetOpacity:0};this.particles.push(d)}console.log(`Created grid: ${n}x${h} = ${this.particles.length} binary digits`)}_getParticleCount(){if(!this.config.autoScaleParticles)return this.config.particleCount;const t=window.innerWidth*window.innerHeight,n=1920*1080,h=Math.sqrt(t/n);return Math.floor(this.config.particleCount*Math.min(h,1.5))}_setupEventListeners(){this._onMouseMove=t=>{this.cursor.x=t.clientX,this.cursor.y=t.clientY},window.addEventListener("mousemove",this._onMouseMove,{passive:!0}),this._onResize=()=>this._resize(),window.addEventListener("resize",this._onResize,{passive:!0}),this._onVisibilityChange=()=>{this.isActive=!document.hidden,this.isActive&&!this.animationFrameId&&this._startAnimation()},document.addEventListener("visibilitychange",this._onVisibilityChange),this._onDarkModeChange=()=>{this._createParticles()},this._darkModeObserver=new MutationObserver(t=>{t.forEach(n=>{n.attributeName==="class"&&this._onDarkModeChange()})}),this._darkModeObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),window.matchMedia&&(this._darkModeQuery=window.matchMedia("(prefers-color-scheme: dark)"),this._darkModeQuery.addEventListener("change",this._onDarkModeChange))}_resize(){const t=Math.min(window.devicePixelRatio||1,2);this.canvas.width=window.innerWidth*t,this.canvas.height=window.innerHeight*t,this.canvas.style.width=`${window.innerWidth}px`,this.canvas.style.height=`${window.innerHeight}px`,this.ctx.scale(t,t),this._createParticles()}_updatePhysics(){const t=this.config.cursorInfluenceRadius,n=150;for(let h=0;h<this.particles.length;h++){const s=this.particles[h],a=this.cursor.x-s.x,r=this.cursor.y-s.y,c=a*a+r*r,l=Math.sqrt(c);if(l<n){const u=1-l/n;s.targetOpacity=u*this.config.opacity}else s.targetOpacity=0;if(s.opacity+=(s.targetOpacity-s.opacity)*.1,l<t&&l>.1){const u=this.config.attractionStrength*Math.pow(1-l/t,2);s.vx-=a/l*u*(1/s.mass),s.vy-=r/l*u*(1/s.mass)}if(l<t&&l>10){const u=this.config.orbitalStrength*(1-l/t);s.vx+=-r/l*u,s.vy+=a/l*u}const i=.01,d=s.originX-s.x,x=s.originY-s.y;s.vx+=d*i,s.vy+=x*i,s.vx*=this.config.damping,s.vy*=this.config.damping,s.x+=s.vx,s.y+=s.vy}}_render(){this.ctx.clearRect(0,0,window.innerWidth,window.innerHeight),this.ctx.font="bold 16px monospace",this.ctx.textAlign="center",this.ctx.textBaseline="middle";for(const t of this.particles){if(t.opacity<.01)continue;const{r:n,g:h,b:s}=t.color;this.ctx.fillStyle=`rgba(${n}, ${h}, ${s}, ${t.opacity})`,this.ctx.fillText(t.digit,t.x,t.y)}}_startAnimation(){const t=()=>{if(!this.isActive){this.animationFrameId=null;return}this._updatePhysics(),this._render(),this.animationFrameId=requestAnimationFrame(t)};t()}updateConfig(t){Object.assign(this.config,t),t.particleCount&&this._createParticles()}pause(){this.isActive=!1}resume(){this.isActive||(this.isActive=!0,this._startAnimation())}destroy(){this.isActive=!1,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),window.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("resize",this._onResize),document.removeEventListener("visibilitychange",this._onVisibilityChange),this._darkModeObserver&&this._darkModeObserver.disconnect(),this._darkModeQuery&&this._onDarkModeChange&&this._darkModeQuery.removeEventListener("change",this._onDarkModeChange),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null,this.ctx=null,this.particles=[]}}function De(){const[o,t]=m.useState("dashboard");return m.useEffect(()=>{const n=new Oe({zIndex:1,cursorInfluenceRadius:150,attractionStrength:.08,orbitalStrength:.04,damping:.85,opacity:1});return()=>{n.destroy()}},[]),e.jsxs(e.Fragment,{children:[e.jsx(Pe,{}),e.jsx("button",{className:"floating-share-btn",children:"Share"}),e.jsxs("div",{className:"layout",children:[e.jsx(Ie,{activeSection:o,setActiveSection:t}),e.jsx("div",{className:"main-content",children:e.jsx("main",{className:"content",children:e.jsx($e,{activeSection:o,setActiveSection:t})})})]})]})}fe.createRoot(document.getElementById("root")).render(e.jsx(ve.StrictMode,{children:e.jsx(De,{})}));
